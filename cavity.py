import numpy as np
import netCDF4 as nc
import matplotlib.pyplot as plt

data = nc.Dataset("/home/jeonukim/data/cavity/cavity-11000.nc", "r")

x = data["x"][:]
y = data["y"][:]
z = data["z"][:]

Nx = len(x)
Ny = len(y)
Nz = len(z)

u = data["u"][0, :, :, :].T
w = data["w"][0, :, :, :].T

uc = np.mean(u[Nx//2-1:Nx//2+1, Ny//2-1:Ny//2+1, :], axis=(0, 1))
wc = np.mean(w[:, Ny//2-1:Ny//2+1, Nz//2-1:Nz//2+1], axis=(1, 2))

zm = np.array([0.0072525, 0.0139425, 0.0215705, 0.0333405, 0.0474285, 0.066758, 0.0995715, 0.133524, 0.167678, 0.199968, 0.302752, 0.4019975, 0.501243295, 0.597486, 0.69775, 0.7996765, 0.8314315, 0.865787, 0.901563, 0.935757, 0.954603, 0.970124, 0.983218, 0.990668, 0.998976])
um = np.array([-0.0449291, -0.124173, -0.17318, -0.221974, -0.24046, -0.239466, -0.215822, -0.175653, -0.149195, -0.0899009, -0.0324678, -0.0163831, -0.000298391, 0.0320983, 0.0729352, 0.0946467, 0.0962808, 0.109026, 0.119101, 0.142816, 0.176718, 0.248872, 0.392256, 0.543583, 0.730631])

xm = np.array([0.006618, 0.013971, 0.0186885, 0.032791, 0.046574, 0.0674965, 0.098785, 0.133029, 0.1671665, 0.199684, 0.3002275, 0.401268, 0.4998508045, 0.601318, 0.702572, 0.800977, 0.8351495, 0.8677385, 0.900668, 0.934258, 0.95408, 0.967273, 0.981212, 0.9876915, 0.994064])
wm = np.array([0.0618474, 0.100103, 0.146804, 0.176373, 0.18109, 0.207495, 0.186314, 0.18154, 0.168482, 0.136175, 0.058423, 0.0193291, 0.00248659, -0.00347175, -0.0259979, -0.0566469, -0.0669437, -0.0937279, -0.20067, -0.362919, -0.422114, -0.356568, -0.233034, -0.156039, -0.087329])

plt.figure(figsize=(8, 8))

plt.plot(uc, 2*z-1, 'k')
plt.plot(um, 2*zm-1, 'ko', markersize=4)

plt.plot(2*x-1, wc, 'r--')
plt.plot(2*xm-1, wm, 'rs', markersize=4)

plt.xlim(-1, 1)
plt.ylim(-1, 1)
plt.gca().set_aspect('equal', adjustable='box')

plt.show()
